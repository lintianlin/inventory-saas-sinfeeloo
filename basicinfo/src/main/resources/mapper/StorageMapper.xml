<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sinfeeloo.inventory.mapper.StorageMapper">
    <resultMap id="BaseResultMap" type="com.sinfeeloo.inventory.entity.Storage">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 24 17:00:10 CST 2018.
        -->
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="code" property="code" jdbcType="VARCHAR"/>
        <result column="address" property="address" jdbcType="VARCHAR"/>
        <result column="descs" property="descs" jdbcType="VARCHAR"/>
        <result column="adminId" property="adminid" jdbcType="INTEGER"/>
        <result column="updater" property="updater" jdbcType="VARCHAR"/>
        <result column="updatimeStr" property="updatimeStr" jdbcType="VARCHAR"/>
        <result column="adminName" property="adminName" jdbcType="VARCHAR"/>
        <result column="updatime" property="updatime" jdbcType="TIMESTAMP"/>
        <result column="state" property="state" jdbcType="INTEGER"/>
    </resultMap>


    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 24 17:00:10 CST 2018.
        -->
        select id, name, code, address, descs, adminId, updater, updatime, state
        from lz_base_repo
        where id = #{id,jdbcType=INTEGER}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 24 17:00:10 CST 2018.
        -->
        select id, name, code, address, descs, adminId, updater, updatime, state
        from lz_base_repo
    </select>


    <!--添加仓库-->
    <insert id="insert" parameterType="com.sinfeeloo.inventory.entity.Storage">
      insert into lz_base_repo (id, name, code,
      address, descs, adminId,
      updater, updatime, state
      )
      values (#{id,jdbcType=INTEGER}, #{name,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR},
      #{address,jdbcType=VARCHAR}, #{descs,jdbcType=VARCHAR}, #{adminid,jdbcType=INTEGER},
      #{updater,jdbcType=VARCHAR}, now(), #{state,jdbcType=INTEGER}
      )
  </insert>

    <!--分页查询仓库列表-->
    <select id="selectStorageListByPage" resultMap="BaseResultMap">
        SELECT
        r.id,
        r.name,
        r.code,
        r.address,
        r.descs,
        r.adminId,
        r.updater,
        r.updatime,
        DATE_FORMAT(
        r.updatime,
        '%Y-%m-%d %H:%i:%s'
        ) AS updatimeStr,
        e.`name` AS adminName
        FROM
        lz_base_repo r
        LEFT JOIN lz_base_employee e ON r.adminId = e.id
        WHERE
        r.state = 1
        <if test="storageName != null and storageName!=''">
            AND r.name LIKE CONCAT ('%',#{storageName},'%' )
        </if>
    </select>

    <!--分页查询库存数量-->
    <select id="selectStorageCount" resultType="long">
        SELECT
        count(1)
        FROM
        lz_base_repo
        WHERE
        state = 1
        <if test="storageName != null and storageName!=''">
            AND name LIKE CONCAT ('%',#{storageName},'%' )
        </if>
    </select>

    <!--修改-->
    <update id="updateByPrimaryKey" parameterType="com.sinfeeloo.inventory.entity.Storage">
        update lz_base_repo
        set name = #{name,jdbcType=VARCHAR},
        code = #{code,jdbcType=VARCHAR},
        address = #{address,jdbcType=VARCHAR},
        descs = #{descs,jdbcType=VARCHAR},
        adminId = #{adminid,jdbcType=INTEGER},
        updater = #{updater,jdbcType=VARCHAR},
        updatime = now()
        where id = #{id,jdbcType=INTEGER}
        AND state = 1
    </update>


    <!--删除-->
    <update id="deleteByPrimaryKey" parameterType="com.sinfeeloo.inventory.entity.Storage">
        update lz_base_repo
        set state = 0,
        updater = #{updater,jdbcType=VARCHAR},
        updatime = now()
        where id = #{id,jdbcType=INTEGER}
        AND state = 1
    </update>
</mapper>
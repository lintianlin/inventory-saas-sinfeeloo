<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sinfeeloo.inventory.mapper.EmployeeMapper">
    <resultMap id="BaseResultMap" type="com.sinfeeloo.inventory.entity.Employee">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 24 17:00:10 CST 2018.
        -->
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="code" property="code" jdbcType="VARCHAR"/>
        <result column="idCard" property="idcard" jdbcType="VARCHAR"/>
        <result column="mobile" property="mobile" jdbcType="VARCHAR"/>
        <result column="sex" property="sex" jdbcType="INTEGER"/>
        <result column="birthday" property="birthday" jdbcType="DATE"/>
        <result column="birthdayStr" property="birthdayStr" jdbcType="VARCHAR"/>
        <result column="address" property="address" jdbcType="VARCHAR"/>
        <result column="email" property="email" jdbcType="VARCHAR"/>
        <result column="typeName" property="typeName" jdbcType="VARCHAR"/>
        <result column="type" property="type" jdbcType="INTEGER"/>
        <result column="updater" property="updater" jdbcType="VARCHAR"/>
        <result column="updatime" property="updatime" jdbcType="TIMESTAMP"/>
        <result column="state" property="state" jdbcType="INTEGER"/>
    </resultMap>


    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 24 17:00:10 CST 2018.
        -->
        select id,
        name,
        code,
        idCard,
        mobile,
        sex,
        birthday,
        DATE_FORMAT(
        updatime,
        '%Y-%m-%d'
        ) AS birthdayStr,
        address,
        email,
        type,
        updater,
        updatime,
        state
        from lz_base_employee
        where id = #{id,jdbcType=INTEGER}
        AND state = 1
    </select>


    <!--添加-->
    <insert id="insert" parameterType="com.sinfeeloo.inventory.entity.Employee">
        insert into lz_base_employee (id, name, code,
        idCard, mobile, sex,
        birthday, address, email,
        type, updater, updatime,
        state)
        values (#{id,jdbcType=INTEGER}, #{name,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR},
        #{idcard,jdbcType=VARCHAR}, #{mobile,jdbcType=VARCHAR}, #{sex,jdbcType=INTEGER},
        #{birthday,jdbcType=DATE}, #{address,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR},
        #{type,jdbcType=INTEGER}, #{updater,jdbcType=VARCHAR}, now(),
        #{state,jdbcType=INTEGER})
  </insert>

    <!--分页-->
    <select id="selectEmployeeListByPage" resultMap="BaseResultMap">
        SELECT
        e.id,
        e.NAME,
        e.CODE,
        e.idCard,
        e.mobile,
        e.sex,
        e.birthday,
        DATE_FORMAT(
        updatime,
        '%Y-%m-%d'
        ) AS birthdayStr,
        e.address,
        e.email,
        e.type,
        p.name AS typeName,
        e.updater,
        e.updatime,
        DATE_FORMAT(
        e.updatime,
        '%Y-%m-%d %H:%i:%s'
        ) AS updatimeStr
        FROM
        lz_base_employee e
        LEFT JOIN lz_base_param p ON e.type = p.id AND p.state = 1
        WHERE
        e.state = 1
        <if test="name != null and name!=''">
            AND e.name LIKE CONCAT ('%',#{name},'%' )
        </if>
        <if test="mobile != null and mobile!=''">
            AND e.mobile LIKE CONCAT ('%',#{mobile},'%' )
        </if>
        <if test="type != null and type!=''">
            AND e.type =#{type}
        </if>
        ORDER BY ${sortCode} ${sortRole}
        limit #{limit} offset #{offset}
    </select>

    <!--分页-->
    <select id="selectEmployeeListCount" resultType="long">
        SELECT
        count(1)
        FROM
        lz_base_employee
        WHERE
        state = 1
        <if test="name != null and name!=''">
            AND name LIKE CONCAT ('%',#{name},'%' )
        </if>
        <if test="type != null and type!=''">
            AND type =#{type}
        </if>
    </select>

    <!--修改-->
    <update id="updateByPrimaryKey" parameterType="com.sinfeeloo.inventory.entity.Employee">
        update lz_base_employee
        set name = #{name,jdbcType=VARCHAR},
        code = #{code,jdbcType=VARCHAR},
        idCard = #{idcard,jdbcType=VARCHAR},
        mobile = #{mobile,jdbcType=VARCHAR},
        sex = #{sex,jdbcType=INTEGER},
        birthday = #{birthday,jdbcType=DATE},
        address = #{address,jdbcType=VARCHAR},
        email = #{email,jdbcType=VARCHAR},
        type = #{type,jdbcType=INTEGER},
        updater = #{updater,jdbcType=VARCHAR},
        updatime = now()
        where id = #{id,jdbcType=INTEGER}
        AND state = 1
    </update>


    <!--删除-->
    <update id="deleteByPrimaryKey" parameterType="com.sinfeeloo.inventory.entity.Employee">
        update lz_base_employee
        set state = 0,
        updater = #{updater,jdbcType=VARCHAR},
        updatime = now()
        where id = #{id,jdbcType=INTEGER}
        AND state = 1
    </update>
</mapper>